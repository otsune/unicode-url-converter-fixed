# Unicode URL Converter 仕様書 & TODO

## 概要

本拡張機能は、Webページ内の指定された要素に含まれる特殊なUnicode文字（例: ˸, ․, ⁄）を、通常の記号（:、.、/ など）に変換するChrome拡張機能です。

---

## 現状仕様

### 基本機能
- 対象: Webページ内の指定されたタグのテキスト（デフォルト: `<p>`タグ）
- 変換対象文字:
    - ˸ (U+02F8) → :
    - ․ (U+2024) → .
    - ⁄ (U+2044) → /
- 変換はポップアップから「テキストを変換」ボタンで実行
- 変換結果はポップアップに件数付きで表示

### 変換対象文字のカスタマイズ
- ポップアップ画面で変換対象文字の追加・編集・削除が可能
- 変換マップはchrome.storage.localに保存され、次回以降も反映
- 追加時はUnicode文字と変換後文字を1文字ずつ指定
- ドラッグ&ドロップで変換リストの並び替えが可能

### 変換対象タグのカスタマイズ
- 変換対象のHTMLタグをカスタマイズ可能（デフォルト: p）
- 複数のタグをカンマ区切りで指定可能（例: p, div, span）

### 設定のインポート・エクスポート
- 変換マップのJSON形式でのエクスポート機能
- エクスポートした設定ファイルのインポート機能
- バリデーション機能付き

### 変換履歴
- 変換実行時の履歴を保存
- 履歴にはURL、変換文字数、実行日時を含む
- 最新50件まで保存
- 履歴の一括削除機能

### 多言語対応
- 日本語・英語の完全対応
- UIテキスト、エラーメッセージ、コンソールメッセージの多言語化
- ブラウザの言語設定に応じた自動切り替え

### エラーハンドリング
- Content scriptとの通信エラーの詳細なハンドリング
- リトライ機能付きの通信確立
- Chrome内部ページでの動作制限
- ファイルURLでの動作制限

### 技術仕様
- Manifest V3対応
- ES6モジュール対応（popup.js）
- 通常スクリプト対応（content.js）
- Jestによるユニットテスト実装
- chrome.storage.localによる設定保存
- chrome.scripting APIによる動的スクリプト注入

---

## 完了したTODO

✅ **UI改善**
- 変換対象リストの並び替え機能（ドラッグ&ドロップ）
- 変換対象の説明やUnicodeコードポイント表示の強化
- 編集時のバリデーション強化（1文字制限や重複チェック）

✅ **機能拡張**
- 変換対象の一括インポート・エクスポート機能
- 変換履歴の保存・表示
- 変換対象タグのカスタマイズ（p以外も選択可能に）

✅ **ユーザビリティ**
- 設定のリセット（デフォルトに戻す）ボタン
- 多言語対応（日本語・英語切替）

✅ **技術的改善**
- ユニットテスト・自動テストの導入
- コードのリファクタリングとモジュール分割

---

## 今後の改善案

### 新機能提案
1. **変換プリセット機能**
   - よく使う変換設定のプリセット保存・読み込み
   - プリセットの共有機能

2. **高度な変換ルール**
   - 正規表現による複雑な変換パターン
   - 条件付き変換（特定の要素内のみ）

3. **パフォーマンス最適化**
   - 大量のテキスト処理時の最適化
   - 変換処理の非同期化

4. **アクセシビリティ向上**
   - キーボードショートカット対応
   - スクリーンリーダー対応

### 技術的改善
1. **テスト強化**
   - E2Eテストの追加
   - パフォーマンステストの実装

2. **セキュリティ強化**
   - CSP（Content Security Policy）の最適化
   - 入力値のサニタイゼーション強化

---

> 本仕様書およびTODOは2024年12月時点の内容です。 